# Supabase Integration for notes_frontend

This React app uses Supabase for authentication and as a Postgres backend for storing user notes.

## Required Environment Variables

- `REACT_APP_SUPABASE_URL`: The Supabase project URL
- `REACT_APP_SUPABASE_KEY`: The public anon key for Supabase

## Auth
- Uses Supabase Auth for email/password sign-up and sign-in.
- The app listens for auth state changes and presents note data only for the logged-in user.

## Notes Table (Postgres)

You must create a `notes` table in your Supabase SQL database:

```sql
create table notes (
  id bigint generated by default as identity primary key,
  user_id uuid references auth.users(id) not null,
  title text not null,
  content text,
  inserted_at timestamp with time zone default timezone('utc'::text, now()) not null,
  updated_at timestamp with time zone default timezone('utc'::text, now()) not null
);

-- triggers for updated_at
create or replace function handle_updated_at()
returns trigger as $$
begin
  new.updated_at = now();
  return new;
end;
$$ language plpgsql;

drop trigger if exists set_updated_at on notes;
create trigger set_updated_at
before update on notes
for each row
execute procedure handle_updated_at();
```

## Security

- Only allow logged-in users to select, insert, update, and delete notes _that belong to them_:

```sql
-- Row-level security
alter table notes enable row level security;

create policy "Users can CRUD their own notes" on notes
  for all
  using (auth.uid() = user_id);
```

## Usage

In the React app, Supabase is used for:
- User authentication
- CRUD operations on the `notes` table, scoped by user_id
